<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Farhat's Elephant World | R & F üíñ</title>
<style>
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body{height:100%;font-family:'Georgia',serif;background:#050714;color:#fff;overflow:hidden; scroll-behavior: smooth;}
    .stars{position:fixed;inset:0;background:radial-gradient(1px 1px at 10% 20%,#fff,transparent),radial-gradient(2px 2px at 40% 50%,#fff,transparent);background-size:200% 200%;animation:drift 100s linear infinite;z-index:-1;}
    @keyframes drift{from{background-position:0 0} to{background-position:200% 200%;}}

    /* SLOW CURSOR TRAIL */
    .trail { 
        position: fixed; 
        pointer-events: none; 
        font-size: 28px; /* Increased size for visibility */
        z-index: 9999; 
        animation: floatUp 2.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards; /* Slower, smoother animation */
    }
    @keyframes floatUp { 
        0% { opacity: 1; transform: translateY(0) scale(1); }
        100% { opacity: 0; transform: translateY(-80px) scale(2); } 
    }

    /* INTERFACE */
    .meter-container { position: fixed; top: 15px; left: 50%; transform: translateX(-50%); width: 250px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; border: 1px solid #ff69b4; z-index: 2000; }
    .meter-fill { width: 0%; height: 100%; background: #ff69b4; border-radius: 10px; transition: 1.2s; box-shadow: 0 0 10px #ff69b4; }
    .clock-container { position: fixed; bottom: 15px; right: 15px; background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); padding: 10px; border-radius: 12px; border: 1px solid #ff69b4; z-index: 2000; font-size: 0.7rem; text-align: right; line-height: 1.4; }

    .reel{height:100vh; overflow-y: hidden; scroll-snap-type: y mandatory;}
    .frame{height:100vh; scroll-snap-align:start; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:30px; text-align:center; position:relative;}
    .text{max-width:800px; font-size:2rem; line-height:1.5; margin-bottom:20px; text-shadow: 0 0 10px #ff69b4;}

    /* MAP & FLIGHT */
    .map-svg { width: 100%; max-width: 700px; height: auto; overflow: visible; }
    .path-dotted { stroke: rgba(255,105,180,0.4); stroke-width: 2; fill: none; stroke-dasharray: 8; }
    #plane-icon { font-size: 24px; offset-path: path("M100,200 C150,50 550,50 700,250"); offset-rotate: auto; position: absolute; display: none; z-index: 10; }

    /* GAME UI */
    .box{background:rgba(255,255,255,0.08); backdrop-filter:blur(15px); border:1px solid rgba(255,255,255,0.2); padding:25px; border-radius:20px; width:100%; max-width:450px;}
    .btn-opt{display:block; width:100%; padding:12px; margin:8px 0; background:transparent; border:1px solid #ff69b4; color:#fff; border-radius:30px; cursor:pointer; font-family: inherit; transition: 0.3s;}
    .btn-opt:hover{background: rgba(255,105,180,0.3);}
    
    .scratch-gallery { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;}
    .scratch-card { position: relative; width: 130px; height: 130px; border: 1px solid #ff69b4; border-radius: 10px; overflow: hidden; background: #1a2147; }
    .scratch-canvas { position: absolute; top: 0; left: 0; z-index: 2; cursor: crosshair; touch-action: none; }
    .scratch-reveal { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: #ff69b4; padding: 5px; z-index: 1; text-align: center; font-weight: bold;}

    .ttt-grid{display:grid; grid-template-columns:repeat(3, 75px); gap:8px; margin-top:15px;}
    .cell{width:75px; height:75px; background:rgba(255,255,255,0.1); border:1px solid #ff69b4; display:flex; align-items:center; justify-content:center; font-size:2rem; cursor:pointer; border-radius: 8px;}

    /* HEART PATH */
    .path-line{ stroke:#ff69b4; stroke-width:3; fill: rgba(255, 105, 180, 0); filter:drop-shadow(0 0 10px #ff69b4); opacity:0; transition: opacity 2s, fill 2s; }
    .step{position:absolute; width:26px; height:26px; background:#ff69b4; border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:10px; z-index: 5;}
    #heartInitials { position:absolute; font-size:3rem; color:#ff69b4; top:50%; left:50%; transform:translate(-50%,-50%); opacity:0; font-weight:bold; transition: opacity 2s; z-index: 10; }

    /* GIFT */
    .gift-container { position: relative; width: 180px; height: 180px; cursor: pointer; }
    .gift-box { width: 100%; height: 100%; background: #ff69b4; border-radius: 8px; position: relative; transition: 0.5s; z-index: 2; display: flex; align-items: center; justify-content: center; font-size: 3rem;}
    .gift-lid { width: 110%; height: 35px; background: #ff1493; position: absolute; top: -10px; left: -5%; border-radius: 4px; transition: 0.8s; z-index: 3;}
    .unwrapped .gift-lid { transform: translateY(-120px) rotate(20deg); opacity: 0; }
    .unwrapped .gift-box { transform: scale(0); opacity: 0; }
    .reveal-gift { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: #fff; color: #000; border-radius: 8px; opacity: 0; transform: scale(0.5); transition: 1s; z-index: 1; padding: 10px; text-align: center; font-weight: bold;}
    .unwrapped .reveal-gift { opacity: 1; transform: scale(1.3); z-index: 4; }

    .modal{position:fixed; inset:0; background:rgba(0,0,0,0.95); display:none; align-items:center; justify-content:center; z-index:4000;}
</style>
</head>
<body>
<div class="stars"></div>
<audio id="bgm" loop><source src="bollywood-love.mp3" type="audio/mpeg"></audio>

<div class="meter-container"><div class="meter-fill" id="loveMeter"></div></div>
<div class="clock-container">
    <div style="color:#ff69b4; font-weight:bold; margin-bottom:4px;">üêò The Elephant World üêò</div>
    <div>Parlin: <span id="myTime">00:00</span></div>
    <div>Vadodara: <span id="herTime">00:00</span></div>
</div>

<div class="reel" id="reel">
    <section class="frame"><div class="text" id="typewriter"></div><button class="btn-opt" style="width:250px" onclick="unlockNext()">Enter Her Elephant World üêò</button></section>

    <section class="frame">
        <div class="text">Connecting Parlin to Her Sanctuary üåç</div>
        <div style="position: relative; width: 100%; max-width: 700px;">
            <div id="plane-icon">‚úàÔ∏è</div>
            <svg class="map-svg" viewBox="0 0 800 400">
                <path id="flight-path" class="path-dotted" d="M100,200 C150,50 550,50 700,250" />
                <circle cx="100" cy="200" r="5" fill="#ff69b4" />
                <circle cx="700" cy="250" r="5" fill="#ff69b4" />
                <text x="60" y="230" fill="#fff" font-size="14">Parlin</text>
                <text x="660" y="280" fill="#fff" font-size="14">Vadodara üêò</text>
            </svg>
        </div>
        <button id="start-btn" class="btn-opt" style="width:220px; margin-top:20px;" onclick="startFlight()">Send Birthday Trunk-fulls of Love</button>
    </section>

    <section class="frame">
        <div class="text">Elephant Memory Quiz üêò</div>
        <div class="box" id="quizBox">
            <p id="qText" style="margin-bottom:15px;"></p>
            <div id="quizOptions"></div>
        </div>
    </section>

    <section class="frame">
        <div class="text">The Sanctuary Maze üå≥</div>
        <div class="box">
            <p style="margin-bottom:20px;">An elephant never forgets... but which path leads back to your favorite human?</p>
            <button class="btn-opt" onclick="reveal('Even in your elephant world, you let me in. ‚ù§Ô∏è', true); updateMeter(40);">Follow the trail of peanuts ü•ú</button>
            <button class="btn-opt" onclick="reveal('Oh no! This path is just more elephants. (Not that you mind!) üêò', false)">Stay in the Elephant World alone</button>
        </div>
    </section>

    <section class="frame">
        <div class="text">Scratch for Trunk-fuls of Secrets üíå</div>
        <div class="scratch-gallery">
            <div class="scratch-card"><div class="scratch-reveal">Giant Elephant Hug ü´Ç</div><canvas class="scratch-canvas" width="130" height="130"></canvas></div>
            <div class="scratch-card"><div class="scratch-reveal">A Trip to Thailand? ‚úàÔ∏è</div><canvas class="scratch-canvas" width="130" height="130"></canvas></div>
            <div class="scratch-card"><div class="scratch-reveal">My Whole Heart ‚ù§Ô∏è</div><canvas class="scratch-canvas" width="130" height="130"></canvas></div>
        </div>
        <button id="scratch-unlock-btn" class="btn-opt" style="width:200px; display:none; margin: 0 auto;" onclick="updateMeter(55); reveal('All secrets found! Time for Level 4!', true)">Continue Adventure</button>
    </section>

    <section class="frame">
        <div class="text">XOXO Challenge ‚≠ï‚ùå</div>
        <div class="ttt-grid">
            <div class="cell" onclick="playTTT(0)"></div><div class="cell" onclick="playTTT(1)"></div><div class="cell" onclick="playTTT(2)"></div>
            <div class="cell" onclick="playTTT(3)"></div><div class="cell" onclick="playTTT(4)"></div><div class="cell" onclick="playTTT(5)"></div>
            <div class="cell" onclick="playTTT(6)"></div><div class="cell" onclick="playTTT(7)"></div><div class="cell" onclick="playTTT(8)"></div>
        </div>
        <p style="margin-top:10px; font-size:0.8rem; color:#ff69b4;">Even elephants have to win to pass! üêò</p>
    </section>

    <section class="frame" id="pathFrame">
        <div class="text">One Path, Two Hearts ü§ç</div>
        <div id="pathArea" style="position:relative; width:450px; height:450px;">
            <svg width="450" height="450"><path id="heartPath" class="path-line"></path></svg>
            <div id="heartInitials">R & F</div>
        </div>
    </section>

    <section class="frame">
        <div class="text">Final Birthday Reveal üéÅ</div>
        <div class="gift-container" id="gift" onclick="unwrap()">
            <div class="gift-lid"></div>
            <div class="gift-box">üêò</div>
            <div class="reveal-gift">
                <div>
                    <p>Happy Birthday, Farhat! üéÇ</p>
                    <p style="font-size:0.8rem; margin-top:10px;">I'm glad you let me visit your Elephant World. ‚ù§Ô∏è</p>
                </div>
            </div>
        </div>
    </section>
</div>

<div class="modal" id="modal"><div style="background:#0b1023; padding:40px; border-radius:20px; border:2px solid #ff69b4; text-align:center;"><p id="modalMsg"></p><br><button onclick="closeModal()" style="color:#ff69b4; background:none; border:none; cursor:pointer; font-weight:bold;">Next</button></div></div>

<script>
    const bgm = document.getElementById('bgm');
    const reel = document.getElementById('reel');
    const meter = document.getElementById('loveMeter');
    let canScroll = false;
    let currentLevel = 0;
    let lastTrailTime = 0;

    // REFINED CURSOR TRAIL
    document.addEventListener('mousemove', (e) => {
        const currentTime = Date.now();
        // Slowing the cursor speed: only spawn every 60ms
        if (currentTime - lastTrailTime < 60) return; 
        lastTrailTime = currentTime;

        const t = document.createElement('div');
        t.className = 'trail';
        t.innerText = Math.random() > 0.5 ? 'üêò' : 'üíñ';
        t.style.left = e.clientX + 'px';
        t.style.top = e.clientY + 'px';
        document.body.appendChild(t);
        // Animation is now slower (2.5s) to make them easier to see
        setTimeout(() => t.remove(), 2500); 
    });

    document.body.addEventListener('click',()=>bgm.play().catch(()=>{}),{once:true});

    reel.addEventListener('scroll', (e) => {
        if (!canScroll) { reel.scrollTop = currentLevel * window.innerHeight; }
    });

    function unlockNext() {
        canScroll = true; currentLevel++;
        reel.style.overflowY = "scroll";
        reel.scrollTo({ top: currentLevel * window.innerHeight, behavior: 'smooth' });
        setTimeout(() => { reel.style.overflowY = "hidden"; canScroll = false; }, 1200);
    }

    const intro = "PARLIN TO VADODARA: EXPRESS DELIVERY TO THE ELEPHANT SANCTUARY. üêò‚úàÔ∏è";
    let cIdx = 0; function type() { if(cIdx < intro.length){ document.getElementById("typewriter").innerHTML += intro.charAt(cIdx++); setTimeout(type, 100); } }
    window.onload = type;

    setInterval(() => {
        const now = new Date();
        document.getElementById('myTime').innerText = now.toLocaleTimeString('en-US', {hour:'2-digit', minute:'2-digit', timeZone:'America/New_York'});
        document.getElementById('herTime').innerText = now.toLocaleTimeString('en-US', {hour:'2-digit', minute:'2-digit', timeZone:'Asia/Kolkata'});
    }, 1000);

    function startFlight() {
        const p = document.getElementById('plane-icon');
        document.getElementById('start-btn').style.display = 'none';
        p.style.display = 'block';
        p.animate([{ offsetDistance: "0%" }, { offsetDistance: "100%" }], { duration: 4500, easing: 'ease-in-out', fill: 'forwards' });
        setTimeout(() => { updateMeter(15); unlockNext(); }, 4500);
    }

    const qData = [{q:"Which platform did we first speak on?", a:["Instagram","WhatsApp"], c:1}, {q:"What animal world do you live in?", a:["The Real World","Elephant World üêò"], c:1}];
    let curQ = 0;
    function loadQuiz() {
        const d = qData[curQ]; document.getElementById('qText').innerText = d.q;
        document.getElementById('quizOptions').innerHTML = d.a.map((opt, i) => `<button class="btn-opt" onclick="checkQuiz(${i})">${opt}</button>`).join('');
    }
    function checkQuiz(i) {
        if(i === qData[curQ].c) { 
            curQ++; if(curQ < qData.length) { reveal("Correct! üêò‚ù§Ô∏è", false); loadQuiz(); } 
            else { updateMeter(30); reveal("Level Clear! Transitioning... ‚úàÔ∏è", true); } 
        } else { alert("Oh no! The elephants are disappointed. Try again!"); }
    }
    loadQuiz();

    let scratchCounts = [0, 0, 0];
    document.querySelectorAll('.scratch-canvas').forEach((cvs, idx) => {
        const ctx = cvs.getContext('2d'); ctx.fillStyle = '#888'; ctx.fillRect(0,0,130,130); ctx.globalCompositeOperation = 'destination-out';
        const scratchFunc = (e) => {
            const r = cvs.getBoundingClientRect();
            const x = (e.clientX || e.touches?.[0].clientX) - r.left;
            const y = (e.clientY || e.touches?.[0].clientY) - r.top;
            ctx.beginPath(); ctx.arc(x, y, 18, 0, Math.PI*2); ctx.fill();
            scratchCounts[idx]++;
            if (scratchCounts.every(count => count > 50)) {
                document.getElementById('scratch-unlock-btn').style.display = 'block';
            }
        };
        cvs.addEventListener('mousemove', scratchFunc);
        cvs.addEventListener('touchmove', scratchFunc);
    });

    let bt = ["","","","","","","","",""];
    function playTTT(i) {
        if(bt[i]==="") {
            bt[i]="X"; document.getElementsByClassName('cell')[i].innerText="X";
            if(checkW("X")) { updateMeter(75); reveal("You won! A victory for Elephant-kind. ‚ù§Ô∏è", true); return; }
            if(bt.filter(v=>v==="").length === 0) { alert("Tie! Resetting..."); resetTTT(); return; }
            setTimeout(() => { 
                let e = bt.map((v,idx)=>v===""?idx:null).filter(v=>v!==null); 
                if(e.length){ 
                    let m=e[Math.floor(Math.random()*e.length)]; 
                    bt[m]="O"; document.getElementsByClassName('cell')[m].innerText="O"; 
                    if(checkW("O")) { alert("I won! Restarting..."); resetTTT(); }
                } 
            }, 300);
        }
    }
    function resetTTT() { bt = ["","","","","","","","",""]; Array.from(document.getElementsByClassName('cell')).forEach(c => c.innerText = ""); }
    function checkW(p) { return [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]].some(s => s.every(i => bt[i] === p)); }

    function hXY(t, s=12, oX=225, oY=210){ return { x: s*16*Math.pow(Math.sin(t),3)+oX, y: -s*(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))+oY }; }
    let pathD = ""; for(let i=0; i<=6.28; i+=0.1){ let {x,y} = hXY(i); pathD += (i===0?"M":"L")+x+" "+y+" "; }
    document.getElementById('heartPath').setAttribute("d", pathD);
    for(let k=0; k<20; k++){
        let {x,y} = hXY((k/19)*6.28); let s = document.createElement('div'); s.className = 'step'; s.style.left = (x-13)+'px'; s.style.top = (y-13)+'px'; s.innerText = k+1;
        s.onclick = () => { reveal(`Memory ${k+1}: Even elephants never forget this day.`, false); if(k===19) finishHeart(); };
        document.getElementById('pathArea').appendChild(s);
    }
    function finishHeart() {
        const hp = document.getElementById('heartPath');
        hp.style.opacity = "1"; hp.style.fill = "rgba(255, 105, 180, 0.3)";
        document.getElementById('heartInitials').style.opacity = "1";
        document.querySelectorAll('.step').forEach(step => step.style.display = 'none');
        updateMeter(90); setTimeout(unlockNext, 3000);
    }

    function reveal(m, s) { document.getElementById('modalMsg').innerText = m; document.getElementById('modal').style.display = 'flex'; sn = s; }
    function closeModal() { document.getElementById('modal').style.display = 'none'; if(sn) unlockNext(); }
    function updateMeter(v) { meter.style.width = v + '%'; }
    function unwrap() { document.getElementById('gift').classList.add('unwrapped'); updateMeter(100); }
</script>
</body>
</html>